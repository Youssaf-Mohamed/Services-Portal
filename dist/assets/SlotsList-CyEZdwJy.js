import{_ as O,i as $,j as T,k as i,r as d,o as n,l as u,a as e,b as p,c as r,F as g,f as S,t as s,q as w,p as v,d as B,v as N,D as j,A as q}from"./index-Bc4wcCny.js";import{a as z,P as H,B as f}from"./PageHeader-DedF_tvu.js";import{B as U}from"./Badge-DkpUI6Z9.js";import{M as G}from"./Modal-BPzgvptH.js";import{E as J}from"./EmptyState-BhBk9IQP.js";import{a as C}from"./adminTransport.api-C7MzCjLU.js";/* empty css                                                              *//* empty css                                                              */const K={class:"actions-bar"},Q={class:"filters"},X=["value"],Y={key:0,class:"loading-state"},Z={key:1,class:"error-state"},ee={key:2,class:"table-container"},te={class:"slots-table"},ae={class:"modal-body"},le={class:"form-group"},oe=["disabled"],se=["value"],ne={class:"form-row"},ie={class:"form-group"},re=["value"],de={class:"form-group"},ue={class:"form-row"},ve={class:"form-group"},ce={class:"form-group"},pe={class:"form-group checkbox-group"},me={key:0,class:"error-text"},ye={__name:"SlotsList",setup(fe){const R=d(!0),_=d(null),V=d([]),A=d([]),k=d(""),M=d(!1),c=d(null),m=d(!1),y=d(null),F=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],l=q({route_id:"",day_of_week:0,time:"08:00",direction:"one_way",capacity:30,active:!0}),E=async()=>{try{const o=await C.getRoutes();o.data.success&&(A.value=o.data.data.routes)}catch(o){console.error("Failed to fetch routes:",o)}},b=async()=>{try{R.value=!0,_.value=null;const o={};k.value&&(o.route_id=k.value);const t=await C.getSlots(o);t.data.success&&(V.value=t.data.data.slots)}catch(o){_.value=o.response?.data?.message||"Failed to load slots"}finally{R.value=!1}},I=o=>{c.value=o,l.route_id=o.route?.id||"",l.day_of_week=o.day_of_week,l.time=o.time,l.direction=o.direction,l.capacity=o.capacity,l.active=o.active},x=()=>{M.value=!1,c.value=null,y.value=null,h()},h=()=>{l.route_id="",l.day_of_week=0,l.time="08:00",l.direction="one_way",l.capacity=30,l.active=!0},L=async()=>{try{m.value=!0,y.value=null;const o={route_id:parseInt(l.route_id),day_of_week:parseInt(l.day_of_week),time:l.time,direction:l.direction,capacity:parseInt(l.capacity),active:l.active};c.value?await C.updateSlot(c.value.id,o):await C.createSlot(o),x(),b()}catch(o){y.value=o.response?.data?.message||"Failed to save slot"}finally{m.value=!1}},W=o=>F[o]||"Unknown",P=o=>o==="round_trip"?"Round Trip":"One Way";return $(()=>{E(),b()}),(o,t)=>(n(),T(z,null,{default:i(()=>[u(H,{title:"Schedule Slots",subtitle:"Manage transport schedule slots and capacity",breadcrumbs:[{label:"Admin",to:"/admin/transport"},{label:"Slots"}]}),e("div",K,[e("div",Q,[p(e("select",{"onUpdate:modelValue":t[0]||(t[0]=a=>k.value=a),onChange:b},[t[8]||(t[8]=e("option",{value:""},"All Routes",-1)),(n(!0),r(g,null,S(A.value,a=>(n(),r("option",{key:a.id,value:a.id},s(a.name_en),9,X))),128))],544),[[w,k.value]])]),u(f,{variant:"primary",onClick:t[1]||(t[1]=a=>M.value=!0)},{default:i(()=>[...t[9]||(t[9]=[v(" + Add Slot ",-1)])]),_:1})]),R.value?(n(),r("div",Y,[...t[10]||(t[10]=[e("div",{class:"spinner"},null,-1),e("p",null,"Loading slots...",-1)])])):_.value?(n(),r("div",Z,[e("p",null,s(_.value),1),u(f,{variant:"primary",onClick:b},{default:i(()=>[...t[11]||(t[11]=[v("Retry",-1)])]),_:1})])):(n(),r("div",ee,[e("table",te,[t[13]||(t[13]=e("thead",null,[e("tr",null,[e("th",null,"Route"),e("th",null,"Day"),e("th",null,"Time"),e("th",null,"Direction"),e("th",null,"Capacity"),e("th",null,"Reserved"),e("th",null,"Available"),e("th",null,"Status"),e("th",null,"Actions")])],-1)),e("tbody",null,[(n(!0),r(g,null,S(V.value,a=>(n(),r("tr",{key:a.id},[e("td",null,s(a.route?.name_en||"N/A"),1),e("td",null,s(W(a.day_of_week)),1),e("td",null,s(a.time),1),e("td",null,s(P(a.direction)),1),e("td",null,s(a.capacity),1),e("td",null,s(a.active_reservations_count),1),e("td",null,[u(U,{variant:a.capacity_remaining>0?"success":"danger"},{default:i(()=>[v(s(a.capacity_remaining),1)]),_:2},1032,["variant"])]),e("td",null,[u(U,{variant:a.active?"success":"secondary"},{default:i(()=>[v(s(a.active?"Active":"Inactive"),1)]),_:2},1032,["variant"])]),e("td",null,[u(f,{variant:"secondary",size:"sm",onClick:D=>I(a)},{default:i(()=>[...t[12]||(t[12]=[v(" Edit ",-1)])]),_:1},8,["onClick"])])]))),128))])]),V.value.length===0?(n(),T(J,{key:0,icon:"ðŸ“…",title:"No Slots Found",message:"Create a new schedule slot to get started."})):B("",!0)])),M.value||c.value?(n(),T(G,{key:3,onClose:x},{header:i(()=>[e("h3",null,s(c.value?"Edit Slot":"Create Slot"),1)]),footer:i(()=>[u(f,{variant:"secondary",onClick:x,disabled:m.value},{default:i(()=>[...t[22]||(t[22]=[v(" Cancel ",-1)])]),_:1},8,["disabled"]),u(f,{variant:"primary",onClick:L,disabled:m.value},{default:i(()=>[v(s(m.value?"Saving...":"Save"),1)]),_:1},8,["disabled"])]),default:i(()=>[e("div",ae,[e("div",le,[t[15]||(t[15]=e("label",null,"Route *",-1)),p(e("select",{"onUpdate:modelValue":t[2]||(t[2]=a=>l.route_id=a),disabled:!!c.value},[t[14]||(t[14]=e("option",{value:""},"Select Route",-1)),(n(!0),r(g,null,S(A.value,a=>(n(),r("option",{key:a.id,value:a.id},s(a.name_en),9,se))),128))],8,oe),[[w,l.route_id]])]),e("div",ne,[e("div",ie,[t[16]||(t[16]=e("label",null,"Day of Week *",-1)),p(e("select",{"onUpdate:modelValue":t[3]||(t[3]=a=>l.day_of_week=a)},[(n(),r(g,null,S(F,(a,D)=>e("option",{key:D,value:D},s(a),9,re)),64))],512),[[w,l.day_of_week]])]),e("div",de,[t[17]||(t[17]=e("label",null,"Time *",-1)),p(e("input",{type:"time","onUpdate:modelValue":t[4]||(t[4]=a=>l.time=a)},null,512),[[N,l.time]])])]),e("div",ue,[e("div",ve,[t[19]||(t[19]=e("label",null,"Direction *",-1)),p(e("select",{"onUpdate:modelValue":t[5]||(t[5]=a=>l.direction=a)},[...t[18]||(t[18]=[e("option",{value:"one_way"},"One Way",-1),e("option",{value:"round_trip"},"Round Trip",-1)])],512),[[w,l.direction]])]),e("div",ce,[t[20]||(t[20]=e("label",null,"Capacity *",-1)),p(e("input",{type:"number","onUpdate:modelValue":t[6]||(t[6]=a=>l.capacity=a),min:"1"},null,512),[[N,l.capacity]])])]),e("div",pe,[e("label",null,[p(e("input",{type:"checkbox","onUpdate:modelValue":t[7]||(t[7]=a=>l.active=a)},null,512),[[j,l.active]]),t[21]||(t[21]=v(" Active ",-1))])]),y.value?(n(),r("div",me,s(y.value),1)):B("",!0)])]),_:1})):B("",!0)]),_:1}))}},Ve=O(ye,[["__scopeId","data-v-72be4410"]]);export{Ve as default};
