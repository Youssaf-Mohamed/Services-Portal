import{_ as F,i as L,j as y,k as r,r as v,o as n,l as m,a as t,b as g,c as d,F as b,f as k,t as l,q as x,v as A,p as h,A as I,g as W}from"./index-Bc4wcCny.js";import{a as j,P as q,B as P}from"./PageHeader-DedF_tvu.js";import{C as w}from"./Card-BNSDWmXW.js";import{B as H}from"./Badge-DkpUI6Z9.js";import{E as B}from"./EmptyState-BhBk9IQP.js";import{a as M}from"./adminTransport.api-C7MzCjLU.js";/* empty css                                                             *//* empty css                                                              */const O={class:"filters-grid"},z={class:"form-group"},G=["value"],J={class:"form-group"},K=["value"],Q={class:"form-group"},X={class:"form-group actions"},Y={key:0,class:"loading-state"},Z={key:1,class:"error-state"},$={key:2,class:"manifest-content"},tt={class:"summary-grid"},et={class:"summary-item"},st={class:"value"},at={class:"summary-item"},lt={class:"value"},ot={class:"summary-item"},nt={class:"value"},it={class:"summary-item"},dt={class:"value"},rt={class:"summary-item highlight"},ut={class:"value"},mt={key:1,class:"manifest-table"},vt={__name:"Manifest",setup(_t){const c=v(!1),_=v(null),C=v([]),i=v(null),u=v([]),S=v(0),o=I({route_id:"",day_of_week:0,time:"08:00"}),T=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],V=W(()=>o.route_id&&o.time),D=async()=>{try{const a=await M.getRoutes();a.data.success&&(C.value=a.data.data.routes)}catch(a){console.error("Failed to fetch routes:",a)}},N=async()=>{if(V.value)try{c.value=!0,_.value=null;const a=await M.getManifest({route_id:o.route_id,day_of_week:o.day_of_week,time:o.time});a.data.success&&(i.value=a.data.data.slot,u.value=a.data.data.manifest,S.value=a.data.data.total_passengers)}catch(a){_.value=a.response?.data?.message||"Failed to load manifest",i.value=null,u.value=[]}finally{c.value=!1}},p=()=>{i.value=null,u.value=[],_.value=null},E=()=>{const a=M.getManifestExportUrl({route_id:o.route_id,day_of_week:o.day_of_week,time:o.time});window.open(a,"_blank")},R=a=>T[a]||"Unknown",U=a=>a==="round_trip"?"Round Trip":"One Way";return L(D),(a,e)=>(n(),y(j,null,{default:r(()=>[m(q,{title:"Passenger Manifest",subtitle:"View and export passenger lists for specific routes and schedules",breadcrumbs:[{label:"Admin",to:"/admin/transport"},{label:"Manifest"}]}),m(w,{class:"filters-card"},{default:r(()=>[t("div",O,[t("div",z,[e[4]||(e[4]=t("label",null,"Route *",-1)),g(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>o.route_id=s),onChange:p},[e[3]||(e[3]=t("option",{value:""},"Select Route",-1)),(n(!0),d(b,null,k(C.value,s=>(n(),d("option",{key:s.id,value:s.id},l(s.name_en),9,G))),128))],544),[[x,o.route_id]])]),t("div",J,[e[5]||(e[5]=t("label",null,"Day *",-1)),g(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>o.day_of_week=s),onChange:p},[(n(),d(b,null,k(T,(s,f)=>t("option",{key:f,value:f},l(s),9,K)),64))],544),[[x,o.day_of_week]])]),t("div",Q,[e[6]||(e[6]=t("label",null,"Time *",-1)),g(t("input",{type:"time","onUpdate:modelValue":e[2]||(e[2]=s=>o.time=s),onChange:p},null,544),[[A,o.time]])]),t("div",X,[m(P,{variant:"primary",onClick:N,disabled:!V.value},{default:r(()=>[...e[7]||(e[7]=[h(" Load Manifest ",-1)])]),_:1},8,["disabled"]),m(P,{variant:"secondary",onClick:E,disabled:!u.value||u.value.length===0},{default:r(()=>[...e[8]||(e[8]=[h(" ðŸ“¥ Export CSV ",-1)])]),_:1},8,["disabled"])])])]),_:1}),c.value?(n(),d("div",Y,[...e[9]||(e[9]=[t("div",{class:"spinner"},null,-1),t("p",null,"Loading manifest...",-1)])])):_.value?(n(),d("div",Z,[t("p",null,l(_.value),1)])):i.value?(n(),d("div",$,[m(w,{class:"summary-card"},{default:r(()=>[t("div",tt,[t("div",et,[e[10]||(e[10]=t("span",{class:"label"},"Route",-1)),t("span",st,l(i.value.route_name),1)]),t("div",at,[e[11]||(e[11]=t("span",{class:"label"},"Day",-1)),t("span",lt,l(R(i.value.day_of_week)),1)]),t("div",ot,[e[12]||(e[12]=t("span",{class:"label"},"Time",-1)),t("span",nt,l(i.value.time),1)]),t("div",it,[e[13]||(e[13]=t("span",{class:"label"},"Direction",-1)),t("span",dt,l(U(i.value.direction)),1)]),t("div",rt,[e[14]||(e[14]=t("span",{class:"label"},"Total Passengers",-1)),t("span",ut,l(S.value)+" / "+l(i.value.capacity),1)])])]),_:1}),m(w,null,{header:r(()=>[...e[15]||(e[15]=[t("h3",null,"Passenger List",-1)])]),default:r(()=>[u.value.length===0?(n(),y(B,{key:0,icon:"ðŸ‘¥",title:"No Passengers",message:"There are no active subscriptions with seat reservations for this slot."})):(n(),d("table",mt,[e[16]||(e[16]=t("thead",null,[t("tr",null,[t("th",null,"#"),t("th",null,"Student Name"),t("th",null,"Email"),t("th",null,"Student ID"),t("th",null,"Plan"),t("th",null,"Valid Until")])],-1)),t("tbody",null,[(n(!0),d(b,null,k(u.value,(s,f)=>(n(),d("tr",{key:s.subscription_id},[t("td",null,l(f+1),1),t("td",null,l(s.student_name),1),t("td",null,l(s.student_email),1),t("td",null,l(s.student_id||"N/A"),1),t("td",null,[m(H,{variant:s.plan_type==="monthly"?"info":"secondary"},{default:r(()=>[h(l(s.plan_type),1)]),_:2},1032,["variant"])]),t("td",null,l(s.end_date),1)]))),128))])]))]),_:1})])):(n(),y(B,{key:3,icon:"ðŸ“Š",title:"Select Manifest Criteria",message:"Choose a route, day, and time to view the passenger manifest."}))]),_:1}))}},wt=F(vt,[["__scopeId","data-v-b484ccee"]]);export{wt as default};
