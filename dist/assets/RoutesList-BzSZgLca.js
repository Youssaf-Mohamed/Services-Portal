import{_ as N,i as P,j as x,k as l,r as u,o as i,l as r,a as t,p as d,c as y,t as o,F as T,f as U,b as p,v as f,D as L,d as M,A as S,C as $}from"./index-Bc4wcCny.js";import{a as z,P as I,B as _}from"./PageHeader-DedF_tvu.js";import{C as O}from"./Card-BNSDWmXW.js";import{B as W}from"./Badge-DkpUI6Z9.js";import{M as j}from"./Modal-BPzgvptH.js";import{a as w}from"./adminTransport.api-C7MzCjLU.js";/* empty css                                                             *//* empty css                                                              *//* empty css                                                              */const G={class:"actions-bar"},H={key:0,class:"loading-state"},q={key:1,class:"error-state"},J={key:2,class:"routes-grid"},K={class:"route-header"},Q={class:"route-names"},X={class:"name-ar"},Y={class:"route-info"},Z={class:"info-row"},ee={class:"value"},te={class:"info-row"},ae={class:"value"},se={class:"info-row"},ne={class:"value"},oe={class:"info-row"},le={class:"value"},ie={class:"info-row"},re={class:"value"},de={class:"route-actions"},ue={class:"modal-body"},ce={class:"form-group"},pe={class:"form-group"},_e={class:"form-group"},me={class:"form-row"},ve={class:"form-group"},ye={class:"form-group"},fe={class:"form-group checkbox-group"},ge={key:0,class:"error-text"},be={__name:"RoutesList",setup(we){const V=$(),k=u(!0),g=u(null),h=u([]),C=u(!1),c=u(null),m=u(!1),v=u(null),a=S({name_en:"",name_ar:"",price_one_way:0,monthly_discount_percent:0,term_discount_percent:0,active:!0}),b=async()=>{try{k.value=!0,g.value=null;const n=await w.getRoutes();n.data.success&&(h.value=n.data.data.routes)}catch(n){g.value=n.response?.data?.message||"Failed to load routes"}finally{k.value=!1}},A=n=>{c.value=n,a.name_en=n.name_en,a.name_ar=n.name_ar,a.price_one_way=n.pricing.price_one_way,a.monthly_discount_percent=n.pricing.monthly_discount_percent,a.term_discount_percent=n.pricing.term_discount_percent,a.active=n.active},R=()=>{C.value=!1,c.value=null,v.value=null,F()},F=()=>{a.name_en="",a.name_ar="",a.price_one_way=0,a.monthly_discount_percent=0,a.term_discount_percent=0,a.active=!0},B=async()=>{try{m.value=!0,v.value=null;const n={name_en:a.name_en,name_ar:a.name_ar,price_one_way:parseFloat(a.price_one_way),monthly_discount_percent:parseFloat(a.monthly_discount_percent)||0,term_discount_percent:parseFloat(a.term_discount_percent)||0,active:a.active};c.value?await w.updateRoute(c.value.id,n):await w.createRoute(n),R(),b()}catch(n){v.value=n.response?.data?.message||"Failed to save route"}finally{m.value=!1}},D=async n=>{try{await w.updateRoute(n.id,{active:!n.active}),b()}catch(e){V.error(e.response?.data?.message||"Failed to update route")}};return P(b),(n,e)=>(i(),x(z,null,{default:l(()=>[r(I,{title:"Routes Management",subtitle:"Manage transport routes and stops",breadcrumbs:[{label:"Admin",to:"/admin/transport"},{label:"Routes"}]}),t("div",G,[r(_,{variant:"primary",onClick:e[0]||(e[0]=s=>C.value=!0)},{default:l(()=>[...e[7]||(e[7]=[d(" + Add Route ",-1)])]),_:1})]),k.value?(i(),y("div",H,[...e[8]||(e[8]=[t("div",{class:"spinner"},null,-1),t("p",null,"Loading routes...",-1)])])):g.value?(i(),y("div",q,[t("p",null,o(g.value),1),r(_,{variant:"primary",onClick:b},{default:l(()=>[...e[9]||(e[9]=[d("Retry",-1)])]),_:1})])):(i(),y("div",J,[(i(!0),y(T,null,U(h.value,s=>(i(),x(O,{key:s.id,class:"route-card"},{default:l(()=>[t("div",K,[t("div",Q,[t("h3",null,o(s.name_en),1),t("p",X,o(s.name_ar),1)]),r(W,{variant:s.active?"success":"secondary"},{default:l(()=>[d(o(s.active?"Active":"Inactive"),1)]),_:2},1032,["variant"])]),t("div",Y,[t("div",Z,[e[10]||(e[10]=t("span",{class:"label"},"Price (One Way)",-1)),t("span",ee,o(s.pricing.price_one_way)+" EGP",1)]),t("div",te,[e[11]||(e[11]=t("span",{class:"label"},"Monthly Discount",-1)),t("span",ae,o(s.pricing.monthly_discount_percent)+"%",1)]),t("div",se,[e[12]||(e[12]=t("span",{class:"label"},"Term Discount",-1)),t("span",ne,o(s.pricing.term_discount_percent)+"%",1)]),t("div",oe,[e[13]||(e[13]=t("span",{class:"label"},"Stops",-1)),t("span",le,o(s.stops_count),1)]),t("div",ie,[e[14]||(e[14]=t("span",{class:"label"},"Slots",-1)),t("span",re,o(s.slots_count),1)])]),t("div",de,[r(_,{variant:"secondary",size:"sm",onClick:E=>A(s)},{default:l(()=>[...e[15]||(e[15]=[d(" Edit ",-1)])]),_:1},8,["onClick"]),r(_,{variant:s.active?"danger":"primary",size:"sm",onClick:E=>D(s)},{default:l(()=>[d(o(s.active?"Deactivate":"Activate"),1)]),_:2},1032,["variant","onClick"])])]),_:2},1024))),128))])),C.value||c.value?(i(),x(j,{key:3,onClose:R},{header:l(()=>[t("h3",null,o(c.value?"Edit Route":"Create Route"),1)]),footer:l(()=>[r(_,{variant:"secondary",onClick:R,disabled:m.value},{default:l(()=>[...e[22]||(e[22]=[d(" Cancel ",-1)])]),_:1},8,["disabled"]),r(_,{variant:"primary",onClick:B,disabled:m.value},{default:l(()=>[d(o(m.value?"Saving...":"Save"),1)]),_:1},8,["disabled"])]),default:l(()=>[t("div",ue,[t("div",ce,[e[16]||(e[16]=t("label",null,"Name (English) *",-1)),p(t("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=s=>a.name_en=s),placeholder:"Route name in English"},null,512),[[f,a.name_en]])]),t("div",pe,[e[17]||(e[17]=t("label",null,"Name (Arabic) *",-1)),p(t("input",{type:"text","onUpdate:modelValue":e[2]||(e[2]=s=>a.name_ar=s),placeholder:"اسم الخط بالعربي",dir:"rtl"},null,512),[[f,a.name_ar]])]),t("div",_e,[e[18]||(e[18]=t("label",null,"Price (One Way) *",-1)),p(t("input",{type:"number","onUpdate:modelValue":e[3]||(e[3]=s=>a.price_one_way=s),min:"0",step:"0.01"},null,512),[[f,a.price_one_way]])]),t("div",me,[t("div",ve,[e[19]||(e[19]=t("label",null,"Monthly Discount %",-1)),p(t("input",{type:"number","onUpdate:modelValue":e[4]||(e[4]=s=>a.monthly_discount_percent=s),min:"0",max:"100"},null,512),[[f,a.monthly_discount_percent]])]),t("div",ye,[e[20]||(e[20]=t("label",null,"Term Discount %",-1)),p(t("input",{type:"number","onUpdate:modelValue":e[5]||(e[5]=s=>a.term_discount_percent=s),min:"0",max:"100"},null,512),[[f,a.term_discount_percent]])])]),t("div",fe,[t("label",null,[p(t("input",{type:"checkbox","onUpdate:modelValue":e[6]||(e[6]=s=>a.active=s)},null,512),[[L,a.active]]),e[21]||(e[21]=d(" Active ",-1))])]),v.value?(i(),y("div",ge,o(v.value),1)):M("",!0)])]),_:1})):M("",!0)]),_:1}))}},Be=N(be,[["__scopeId","data-v-16f6b25d"]]);export{Be as default};
